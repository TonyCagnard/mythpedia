{% extends "mythpedia/base.html" %}
{% load static %}

{% block title_tag_content %}Liste des Mythologies - MythPedia{% endblock %}
{% block main_page_heading %}Découvrez les Mythologies du Monde{% endblock %}

{% block content %}
    {% if mythologies_page.object_list %}
        {# En-tête avec informations sur la page actuelle #}
        <div class="mb-8 text-center">
            <p class="text-gray-600 text-lg">
                Page {{ mythologies_page.number }} sur {{ mythologies_page.paginator.num_pages }}
                <span class="mx-2">•</span>
                {{ mythologies_page.paginator.count }} mythologie{{ mythologies_page.paginator.count|pluralize:"s" }} au total
            </p>
        </div>

        {# Grille améliorée de 6 mythologies avec design moderne #}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 md:gap-8 mb-12">
            {% for mythology in mythologies_page.object_list %}
                <div class="group relative bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 overflow-hidden border border-gray-100 transform hover:-translate-y-2">
                    {# Badge d'origine en haut à droite #}
                    <div class="absolute top-4 right-4 z-10 bg-white/90 backdrop-blur-sm rounded-full px-3 py-1 text-xs font-semibold text-gray-700 shadow-md">
                        {{ mythology.origin|default:"Antiquité" }}
                    </div>
                    
                    {# Bannière avec dégradé et motif amélioré #}
                    <div class="h-48 relative overflow-hidden bg-gradient-to-br {{ mythology.color_from|default:"from-blue-500" }} {{ mythology.color_to|default:"to-purple-600" }}">
                        {# Motif décoratif en arrière-plan #}
                        <div class="absolute inset-0 opacity-10">
                            <div class="absolute top-0 left-0 w-full h-full transform rotate-12 scale-150">
                                <div class="grid grid-cols-6 gap-4 p-4">
                                    {% for i in "123456" %}
                                        <div class="bg-white rounded-full h-8 w-8"></div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        
                        {# Icône centrale avec animation #}
                        <div class="relative h-full flex items-center justify-center">
                            <div class="transform transition-transform duration-500 group-hover:scale-110">
                                <i class="fas {{ mythology.icon_class|default:"fa-book" }} text-6xl text-white drop-shadow-lg"></i>
                            </div>
                        </div>
                    </div>
                    
                    {# Contenu de la carte #}
                    <div class="p-6 flex flex-col h-64">
                        <div class="flex-grow">
                            <h3 class="font-bold text-xl text-gray-800 mb-3 group-hover:text-blue-600 transition-colors">
                                {{ mythology.title }}
                            </h3>
                            <p class="text-gray-600 text-sm leading-relaxed mb-4 line-clamp-4">
                                {{ mythology.card_summary|default:mythology.description|truncatewords:20|linebreaksbr }}
                            </p>
                            
                            {# Informations supplémentaires #}
                            <div class="flex items-center text-xs text-gray-500 mb-4">
                                <i class="fas fa-users mr-2"></i>
                                <span>{{ mythology.characters.count }} personnage{{ mythology.characters.count|pluralize:"s" }}</span>
                                <span class="mx-2">•</span>
                                <i class="fas fa-book-open mr-2"></i>
                                <span>{{ mythology.stories.count }} histoire{{ mythology.stories.count|pluralize:"s" }}</span>
                            </div>
                        </div>
                        
                        {# Bouton d'action amélioré #}
                        <div class="flex items-center justify-between">
                            <a href="{% url 'mythpedia:mythology_detail' mythology_slug=mythology.slug %}"
                               class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-sm font-medium rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-md hover:shadow-lg">
                                <span>Explorer</span>
                                <i class="fas fa-arrow-right ml-2 transform group-hover:translate-x-1 transition-transform"></i>
                            </a>
                            
                            {# Icônes d'action rapides #}
                            <div class="flex space-x-2">
                                {% if user.is_authenticated %}
                                    <button class="p-2 text-gray-400 hover:text-red-500 transition-colors" title="Ajouter aux favoris">
                                        <i class="far fa-heart"></i>
                                    </button>
                                {% endif %}
                                <button class="p-2 text-gray-400 hover:text-blue-500 transition-colors" title="Partager">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        {# Pagination améliorée #}
        {% if mythologies_page.has_other_pages %}
            <div class="flex flex-col items-center space-y-4">
                <div class="flex items-center space-x-1 bg-white rounded-lg shadow-md p-1">
                    {% if mythologies_page.has_previous %}
                        <a href="?page=1" class="px-3 py-2 text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors" title="Première page">
                            <i class="fas fa-angle-double-left"></i>
                        </a>
                        <a href="?page={{ mythologies_page.previous_page_number }}" class="px-3 py-2 text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors" title="Page précédente">
                            <i class="fas fa-angle-left"></i>
                        </a>
                    {% else %}
                        <span class="px-3 py-2 text-sm text-gray-400 cursor-not-allowed">
                            <i class="fas fa-angle-double-left"></i>
                        </span>
                        <span class="px-3 py-2 text-sm text-gray-400 cursor-not-allowed">
                            <i class="fas fa-angle-left"></i>
                        </span>
                    {% endif %}

                    {% for i in mythologies_page.paginator.page_range %}
                        {% if mythologies_page.number == i %}
                            <span class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md">{{ i }}</span>
                        {% elif i > mythologies_page.number|add:'-2' and i < mythologies_page.number|add:'2' %}
                            <a href="?page={{ i }}" class="px-3 py-2 text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors">{{ i }}</a>
                        {% elif i == mythologies_page.number|add:'-2' or i == mythologies_page.number|add:'2' %}
                            <span class="px-2 text-sm text-gray-400">...</span>
                        {% endif %}
                    {% endfor %}

                    {% if mythologies_page.has_next %}
                        <a href="?page={{ mythologies_page.next_page_number }}" class="px-3 py-2 text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors" title="Page suivante">
                            <i class="fas fa-angle-right"></i>
                        </a>
                        <a href="?page={{ mythologies_page.paginator.num_pages }}" class="px-3 py-2 text-sm text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors" title="Dernière page">
                            <i class="fas fa-angle-double-right"></i>
                        </a>
                    {% else %}
                        <span class="px-3 py-2 text-sm text-gray-400 cursor-not-allowed">
                            <i class="fas fa-angle-right"></i>
                        </span>
                        <span class="px-3 py-2 text-sm text-gray-400 cursor-not-allowed">
                            <i class="fas fa-angle-double-right"></i>
                        </span>
                    {% endif %}
                </div>
                
                {# Information sur la navigation #}
                <div class="text-center text-sm text-gray-500">
                    <p>Vous consultez la page {{ mythologies_page.number }} sur {{ mythologies_page.paginator.num_pages }}</p>
                </div>
            </div>
        {% endif %}

    {% else %}
        <div class="text-center py-16">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-gray-100 rounded-full mb-6">
                <i class="fas fa-book-open text-3xl text-gray-400"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">Aucune mythologie disponible</h3>
            <p class="text-gray-500 max-w-md mx-auto">
                Les mythologies seront bientôt ajoutées. Revenez plus tard pour découvrir les légendes du monde entier !
            </p>
        </div>
    {% endif %}
{% endblock %}